<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ad Manager Pro - Sign In / Dashboard</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.min.css">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #121212 100%);
      color: #d1d5db;
      min-height: 100vh;
      overflow-x: hidden;
    }
    .auth-container {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 16px;
    }
    .form, .signup-form {
      display: flex;
      flex-direction: column;
      gap: 12px;
      background: rgba(15, 15, 15, 0.95);
      backdrop-filter: blur(15px);
      padding: 24px;
      width: 100%;
      max-width: 420px;
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.05);
      color: #d1d5db;
    }
    .signup-form {
      display: none;
    }
    ::placeholder {
      color: rgba(255, 255, 255, 0.5);
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    }
    .form button, .signup-form button {
      align-self: flex-end;
    }
    .flex-column > label {
      color: #d1d5db;
      font-weight: 600;
      font-size: 13px;
      margin-bottom: 6px;
    }
    .inputForm {
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      height: 48px;
      display: flex;
      align-items: center;
      padding-left: 12px;
      transition: 0.2s ease-in-out;
      background: rgba(255, 255, 255, 0.05);
    }
    .input {
      margin-left: 8px;
      border-radius: 12px;
      border: none;
      width: 100%;
      height: 100%;
      background: transparent;
      color: #d1d5db;
      font-size: 14px;
    }
    .input:focus {
      outline: none;
    }
    .inputForm:focus-within {
      border: 1px solid #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
    }
    .flex-row {
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 8px;
      justify-content: space-between;
      font-size: 13px;
    }
    .checkbox-container {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
    }
    .checkbox-container input[type="checkbox"] {
      width: 16px;
      height: 16px;
      accent-color: #3b82f6;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 4px;
      cursor: pointer;
    }
    .checkbox-container input[type="checkbox"]:checked {
      background: #3b82f6;
      border-color: #3b82f6;
    }
    .span {
      color: #3b82f6;
      font-weight: 500;
      cursor: pointer;
      transition: color 0.2s;
    }
    .span:hover {
      color: #a855f7;
    }
    .button-submit {
      margin: 16px 0 8px 0;
      background: linear-gradient(135deg, #3b82f6 0%, #a855f7 100%);
      border: none;
      color: white;
      font-size: 14px;
      font-weight: 600;
      border-radius: 12px;
      height: 48px;
      width: 100%;
      cursor: pointer;
      transition: 0.2s ease-in-out;
    }
    .button-submit:hover {
      background: linear-gradient(135deg, #2563eb 0%, #9333ea 100%);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
    }
    .p {
      text-align: center;
      color: #6b7280;
      font-size: 13px;
      margin: 4px 0;
    }
    header {
      background: rgba(10, 10, 10, 0.9);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(255,255,255,0.05);
      padding: 16px 32px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 4px 20px rgba(0,0,0,0.4);
    }
    .logo-section {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .logo-icon {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #3b82f6 0%, #a855f7 100%);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
    }
    .logo-text h1 {
      font-size: 22px;
      font-weight: 700;
      background: linear-gradient(135deg, #3b82f6 0%, #a855f7 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .logo-text p {
      font-size: 11px;
      color: #6b7280;
    }
    .profile-section {
      position: relative;
    }
    .profile-icon {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      cursor: pointer;
      object-fit: cover;
      border: 2px solid transparent;
      background: linear-gradient(135deg, #3b82f6 0%, #a855f7 100%);
      padding: 2px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .profile-icon:hover {
      transform: scale(1.08);
      box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
    }
    .settings-menu {
      position: absolute;
      top: 60px;
      right: 0;
      width: 260px;
      background: rgba(15, 15, 15, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 12px;
      overflow: hidden;
      display: none;
      flex-direction: column;
      border: 1px solid rgba(255,255,255,0.05);
      box-shadow: 0 15px 50px rgba(0,0,0,0.5);
    }
    .settings-menu.active { display: flex; }
    .settings-menu button {
      background: none;
      border: none;
      color: #d1d5db;
      padding: 14px 18px;
      text-align: left;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .settings-menu button:hover {
      background: rgba(59, 130, 246, 0.2);
      padding-left: 22px;
    }
    main {
      max-width: 1300px;
      margin: 32px auto;
      padding: 0 32px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
    }
    .section {
      background: rgba(15, 15, 15, 0.7);
      backdrop-filter: blur(15px);
      border-radius: 16px;
      padding: 24px;
      border: 1px solid rgba(255,255,255,0.05);
      box-shadow: 0 6px 24px rgba(0,0,0,0.3);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .section:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 30px rgba(0,0,0,0.4);
    }
    .section-full {
      grid-column: 1 / -1;
    }
    .section-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 1px solid rgba(59, 130, 246, 0.2);
    }
    .section-icon {
      font-size: 24px;
    }
    .section-header h2 {
      font-size: 20px;
      font-weight: 600;
    }
    .form-group {
      margin-bottom: 16px;
    }
    .form-group label {
      display: block;
      margin-bottom: 6px;
      font-size: 13px;
      font-weight: 500;
      color: #9ca3af;
    }
    input, select, textarea {
      width: 100%;
      padding: 12px 16px;
      background: rgba(255,255,255,0.05);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 12px;
      color: #d1d5db;
      font-size: 14px;
      transition: all 0.3s ease;
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
    }
    select {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%23d1d5db' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 10px center;
      background-size: 18px;
      padding-right: 40px;
      cursor: pointer;
    }
    select option {
      background: #1a1a1a;
      color: #d1d5db;
      padding: 10px;
    }
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: rgba(59, 130, 246, 0.5);
      background: rgba(255,255,255,0.08);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2), 0 6px 20px rgba(59, 130, 246, 0.15);
    }
    input:hover, select:hover, textarea:hover {
      border-color: rgba(255,255,255,0.2);
      background: rgba(255,255,255,0.07);
    }
    .price-display {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(168, 85, 247, 0.15) 100%);
      padding: 16px;
      border-radius: 10px;
      margin: 16px 0;
      border: 1px solid rgba(59, 130, 246, 0.2);
    }
    .price-display h3 {
      font-size: 16px;
      margin-bottom: 8px;
    }
    .price-amount {
      font-size: 32px;
      font-weight: 700;
      background: linear-gradient(135deg, #3b82f6 0%, #a855f7 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .price-details {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
      margin-top: 12px;
      font-size: 12px;
      color: #9ca3af;
    }
    .btn {
      padding: 12px 20px;
      border: none;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      justify-content: center;
    }
    .btn-primary {
      background: linear-gradient(135deg, #3b82f6 0%, #a855f7 100%);
      color: white;
      width: 100%;
      margin-top: 8px;
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3);
    }
    .payment-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      margin-top: 16px;
    }
    .payment-option {
      padding: 12px;
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      position: relative;
      text-align: center;
    }
    .payment-option:hover {
      background: rgba(59, 130, 246, 0.15);
      border-color: #3b82f6;
      transform: translateY(-2px);
    }
    .payment-option.disabled {
      opacity: 0.5;
      filter: blur(1px);
      cursor: not-allowed;
      pointer-events: none;
    }
    .payment-option.disabled::after {
      content: 'üîí';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 24px;
      filter: blur(0);
    }
    .payment-icon {
      font-size: 20px;
    }
    .payment-option div {
      display: flex;
      flex-direction: column;
      font-size: 12px;
      font-weight: 500;
    }
    .payment-option div div:first-child {
      font-weight: 600;
      font-size: 13px;
    }
    .slip-upload-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(12px);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }
    .slip-upload-modal.active {
      display: flex;
    }
    .modal-content {
      background: rgba(15, 15, 15, 0.95);
      backdrop-filter: blur(15px);
      border-radius: 16px;
      padding: 32px;
      max-width: 460px;
      width: 90%;
      border: 1px solid rgba(255,255,255,0.05);
      box-shadow: 0 15px 50px rgba(0,0,0,0.5);
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .modal-header h3 {
      font-size: 22px;
      color: #3b82f6;
    }
    .close-modal {
      background: none;
      border: none;
      font-size: 24px;
      color: #6b7280;
      cursor: pointer;
      transition: all 0.3s;
      width: auto;
      padding: 0;
    }
    .close-modal:hover {
      color: #ef4444;
      transform: rotate(90deg);
    }
    .bank-details {
      background: rgba(255,255,255,0.03);
      padding: 16px;
      border-radius: 10px;
      margin-bottom: 20px;
      border: 1px solid rgba(255,255,255,0.05);
    }
    .bank-details p {
      margin: 8px 0;
      color: #d1d5db;
      font-size: 13px;
    }
    .bank-details strong {
      color: #3b82f6;
    }
    .upload-area {
      border: 2px dashed rgba(59, 130, 246, 0.4);
      border-radius: 10px;
      padding: 24px;
      text-align: center;
      margin: 16px 0;
      transition: all 0.3s;
      cursor: pointer;
    }
    .upload-area:hover {
      border-color: #3b82f6;
      background: rgba(59, 130, 246, 0.08);
    }
    .upload-area.drag-over {
      background: rgba(59, 130, 246, 0.15);
      border-color: #3b82f6;
    }
    .upload-icon {
      font-size: 40px;
      margin-bottom: 12px;
    }
    #slipFileInput {
      display: none;
    }
    .file-preview {
      margin-top: 12px;
      padding: 12px;
      background: rgba(34, 197, 94, 0.08);
      border-radius: 8px;
      border: 1px solid rgba(34, 197, 94, 0.2);
      display: none;
      font-size: 13px;
    }
    .file-preview.active {
      display: block;
    }
    .ad-card {
      background: rgba(255,255,255,0.02);
      border: 1px solid rgba(255,255,255,0.05);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
      transition: all 0.3s ease;
    }
    .ad-card:hover {
      background: rgba(255,255,255,0.03);
      border-color: rgba(59, 130, 246, 0.4);
      transform: translateX(4px);
    }
    .ad-card-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 16px;
    }
    .ad-title {
      font-size: 18px;
      font-weight: 600;
      color: #3b82f6;
      margin-bottom: 4px;
    }
    .ad-type-badge {
      padding: 5px 12px;
      background: linear-gradient(135deg, #3b82f6 0%, #a855f7 100%);
      border-radius: 16px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
    }
    .ad-stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      margin: 16px 0;
    }
    .stat-box {
      background: rgba(255,255,255,0.03);
      padding: 12px;
      border-radius: 8px;
      text-align: center;
    }
    .stat-label {
      font-size: 11px;
      color: #6b7280;
      margin-bottom: 4px;
    }
    .stat-value {
      font-size: 20px;
      font-weight: 700;
      color: #3b82f6;
    }
    .stat-value.small {
      font-size: 16px;
    }
    .ad-dates {
      display: flex;
      gap: 16px;
      margin: 12px 0;
      padding: 12px;
      background: rgba(255,255,255,0.02);
      border-radius: 8px;
    }
    .date-item {
      flex: 1;
    }
    .date-label {
      font-size: 11px;
      color: #6b7280;
      margin-bottom: 4px;
    }
    .date-value {
      font-size: 13px;
      font-weight: 600;
      color: #d1d5db;
    }
    .status-badge {
      display: inline-block;
      padding: 5px 10px;
      border-radius: 16px;
      font-size: 11px;
      font-weight: 600;
      margin-top: 8px;
    }
    .status-active {
      background: rgba(34, 197, 94, 0.15);
      color: #22c55e;
      border: 1px solid #22c55e;
    }
    .status-expired {
      background: rgba(239, 68, 68, 0.15);
      color: #ef4444;
      border: 1px solid #ef4444;
    }
    .status-pending {
      background: rgba(251, 191, 36, 0.15);
      color: #facc15;
      border: 1px solid #facc15;
    }
    .status-rejected {
      background: rgba(239, 68, 68, 0.15);
      color: #ef4444;
      border: 1px solid #ef4444;
    }
    .ad-actions {
      display: flex;
      gap: 8px;
      margin-top: 16px;
    }
    .btn-small {
      flex: 1;
      padding: 8px;
      font-size: 12px;
    }
    .btn-danger {
      background: rgba(239, 68, 68, 0.15);
      color: #ef4444;
      border: 1px solid #ef4444;
    }
    .btn-success {
      background: rgba(34, 197, 94, 0.15);
      color: #22c55e;
      border: 1px solid #22c55e;
    }
    .chart-container {
      position: relative;
      height: 360px;
      margin-top: 16px;
    }
    .stats-overview {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
      margin-bottom: 24px;
    }
    .overview-card {
      background: rgba(255,255,255,0.02);
      padding: 20px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.05);
    }
    .overview-icon {
      font-size: 28px;
      margin-bottom: 8px;
    }
    .overview-label {
      font-size: 12px;
      color: #6b7280;
      margin-bottom: 6px;
    }
    .overview-value {
      font-size: 28px;
      font-weight: 700;
      background: linear-gradient(135deg, #3b82f6 0%, #a855f7 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .empty-state {
      text-align: center;
      padding: 48px 16px;
      color: #6b7280;
    }
    .empty-state-icon {
      font-size: 56px;
      margin-bottom: 16px;
      opacity: 0.5;
    }
    .hidden {
      display: none !important;
    }
    @media (max-width: 1200px) {
      main {
        grid-template-columns: 1fr;
      }
      .stats-overview {
        grid-template-columns: repeat(2, 1fr);
      }
    }
    @media (max-width: 768px) {
      header {
        padding: 12px 16px;
      }
      main {
        padding: 0 16px;
      }
      .ad-stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      .payment-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      .stats-overview {
        grid-template-columns: 1fr;
      }
      .auth-container {
        padding: 8px;
      }
      .form, .signup-form {
        padding: 20px;
        max-width: 360px;
      }
    }
  </style>
</head>
<body>
  <!-- Authentication Forms -->
  <div class="auth-container" id="authContainer">
    <!-- Sign In Form -->
    <form class="form" id="signin-form">
      <div class="checkbox-container">
        <input type="checkbox" id="rememberMe">
        <label for="rememberMe">Remember me</label>
        <span class="span" style="margin-left: auto;" onclick="alert('Please contact support@moovied.com to reset your password.')">Forgot password?</span>
      </div>

      <div class="flex-column">
        <label>Email</label>
      </div>
      <div class="inputForm">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" viewBox="0 0 32 32" height="20">
          <path d="m30.853 13.87a15 15 0 0 0 -29.729 4.082 15.1 15.1 0 0 0 12.876 12.918 15.6 15.6 0 0 0 2.016.13 14.85 14.85 0 0 0 7.715-2.145 1 1 0 1 0 -1.031-1.711 13.007 13.007 0 1 1 5.458-6.529 2.149 2.149 0 0 1 -4.158-.759v-10.856a1 1 0 0 0 -2 0v1.726a8 8 0 1 0 .2 10.325 4.135 4.135 0 0 0 7.83.274 15.2 15.2 0 0 0 .823-7.455zm-14.853 8.13a6 6 0 1 1 6-6 6.006 6.006 0 0 1 -6 6z"></path>
        </svg>
        <input placeholder="Enter your Email" class="input" type="email" id="signinEmail" required>
      </div>

      <div class="flex-column">
        <label>Password</label>
      </div>
      <div class="inputForm">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" viewBox="-64 0 512 512" height="20">
          <path d="m336 512h-288c-26.453125 0-48-21.523438-48-48v-224c0-26.476562 21.546875-48 48-48h288c26.453125 0 48 21.523438 48 48v224c0 26.476562-21.546875 48-48 48zm-288-288c-8.8125 0-16 7.167969-16 16v224c0 8.832031 7.1875 16 16 16h288c8.8125 0 16-7.167969 16-16v-224c0-8.832031-7.1875-16-16-16zm0 0"></path>
          <path d="m304 224c-8.832031 0-16-7.167969-16-16v-80c0-52.929688-43.070312-96-96-96s-96 43.070312-96 96v80c0 8.832031-7.167969 16-16 16s-16-7.167969-16-16v-80c0-70.59375 57.40625-128 128-128s128 57.40625 128 128v80c0 8.832031-7.167969 16-16 16zm0 0"></path>
        </svg>
        <input placeholder="Enter your Password" class="input" type="password" id="signinPassword" required>
      </div>

      <button type="submit" class="button-submit" onclick="handleSignIn(event)">Sign In</button>
      <p class="p">Don't have an account? <span class="span" onclick="showSignup()">Sign Up</span></p>
    </form>

    <!-- Sign Up Form -->
    <form class="signup-form" id="signup-form">
      <div class="flex-column">
        <label>Name</label>
      </div>
      <div class="inputForm">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" viewBox="0 0 32 32" height="20">
          <path d="M16 15.5a6.5 6.5 0 1 0 0-13 6.5 6.5 0 0 0 0 13zm0-2a4.5 4.5 0 1 1 0-9 4.5 4.5 0 0 1 0 9zM16 18c-4.42 0-8 3.58-8 8v2h16v-2c0-4.42-3.58-8-8-8zm0 2c3.32 0 6 2.68 6 6H10c0-3.32 2.68-6 6-6z"></path>
        </svg>
        <input placeholder="Enter your Name" class="input" type="text" id="signupName" required>
      </div>

      <div class="flex-column">
        <label>Email</label>
      </div>
      <div class="inputForm">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" viewBox="0 0 32 32" height="20">
          <path d="m30.853 13.87a15 15 0 0 0 -29.729 4.082 15.1 15.1 0 0 0 12.876 12.918 15.6 15.6 0 0 0 2.016.13 14.85 14.85 0 0 0 7.715-2.145 1 1 0 1 0 -1.031-1.711 13.007 13.007 0 1 1 5.458-6.529 2.149 2.149 0 0 1 -4.158-.759v-10.856a1 1 0 0 0 -2 0v1.726a8 8 0 1 0 .2 10.325 4.135 4.135 0 0 0 7.83.274 15.2 15.2 0 0 0 .823-7.455zm-14.853 8.13a6 6 0 1 1 6-6 6.006 6.006 0 0 1 -6 6z"></path>
        </svg>
        <input placeholder="Enter your Email" class="input" type="email" id="signupEmail" required>
      </div>

      <div class="flex-column">
        <label>Business Name</label>
      </div>
      <div class="inputForm">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" viewBox="0 0 32 32" height="20">
          <path d="M28 4h-24c-2.21 0-4 1.79-4 4v16c0 2.21 1.79 4 4 4h24c2.21 0 4-1.79 4-4v16c0-2.21-1.79-4-4-4zm-2 18h-20v-12h20v12z"></path>
        </svg>
        <input placeholder="Enter your Business Name" class="input" type="text" id="signupBusiness" required>
      </div>

      <div class="flex-column">
        <label>Mobile/WhatsApp Number</label>
      </div>
      <div class="inputForm">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" viewBox="0 0 32 32" height="20">
          <path d="M22 2h-12c-2.21 0-4 1.79-4 4v20c0 2.21 1.79 4 4 4h12c2.21 0 4-1.79 4-4v-20c0-2.21-1.79-4-4-4zm-6 24c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm6-6h-12v-12h12v12z"></path>
        </svg>
        <input placeholder="Enter your Mobile/WhatsApp (e.g., 0 or +94)" class="input" type="tel" id="signupPhone" pattern="(\+94\d{9}|0\d{9})" required>
      </div>

      <div class="flex-column">
        <label>Password</label>
      </div>
      <div class="inputForm">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" viewBox="-64 0 512 512" height="20">
          <path d="m336 512h-288c-26.453125 0-48-21.523438-48-48v-224c0-26.476562 21.546875-48 48-48h288c26.453125 0 48 21.523438 48 48v224c0 26.476562-21.546875 48-48 48zm-288-288c-8.8125 0-16 7.167969-16 16v224c0 8.832031 7.1875 16 16 16h288c8.8125 0 16-7.167969 16-16v-224c0-8.832031-7.1875-16-16-16zm0 0"></path>
          <path d="m304 224c-8.832031 0-16-7.167969-16-16v-80c0-52.929688-43.070312-96-96-96s-96 43.070312-96 96v80c0 8.832031-7.167969 16-16 16s-16-7.167969-16-16v-80c0-70.59375 57.40625-128 128-128s128 57.40625 128 128v80c0 8.832031-7.167969 16-16 16zm0 0"></path>
        </svg>
        <input placeholder="Enter your Password" class="input" type="password" id="signupPassword" required>
      </div>

      <button type="submit" class="button-submit" onclick="handleSignUp(event)">Sign Up</button>
      <p class="p">Already have an account? <span class="span" onclick="showSignin()">Sign In</span></p>
    </form>
  </div>

  <!-- Dashboard -->
  <div class="dashboard-container hidden" id="dashboardContainer">
    <header>
      <div class="logo-section">
        <div class="logo-icon">üìä</div>
        <div class="logo-text">
          <h1>Ad Manager Pro</h1>
          <p>Advanced Analytics Dashboard</p>
        </div>
      </div>
      <div class="profile-section">
        <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png" class="profile-icon" id="profileIcon">
        <div class="settings-menu" id="settingsMenu">
          <button onclick="goHome()">üè† Dashboard Home</button>
          <button onclick="changeName()">‚úèÔ∏è Edit Profile</button>
          <button onclick="changeProfileImage()">üñºÔ∏è Change Avatar</button>
          <button onclick="contactMoovied()">üìû Contact Support</button>
          <button onclick="logout()">üö™ Sign Out</button>
        </div>
      </div>
    </header>

    <main>
      <div class="section-full">
        <div class="stats-overview">
          <div class="overview-card">
            <div class="overview-icon">üì∫</div>
            <div class="overview-label">Total Ads</div>
            <div class="overview-value" id="totalAds">0</div>
          </div>
          <div class="overview-card">
            <div class="overview-icon">üëÅÔ∏è</div>
            <div class="overview-label">Total Views</div>
            <div class="overview-value" id="totalViews">0</div>
          </div>
          <div class="overview-card">
            <div class="overview-icon">üëÜ</div>
            <div class="overview-label">Total Clicks</div>
            <div class="overview-value" id="totalClicks">0</div>
          </div>
          <div class="overview-card">
            <div class="overview-icon">‚è±Ô∏è</div>
            <div class="overview-label">Total Watch Time</div>
            <div class="overview-value" id="totalWatchTime">0h</div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-header">
          <span class="section-icon">üöÄ</span>
          <h2>Upload New Advertisement</h2>
        </div>
        
        <div class="form-group">
          <label>Ad Title</label>
          <input type="text" id="adTitle" placeholder="Enter your ad campaign name">
        </div>
        
        <div class="form-group">
          <label>Advertisement Type</label>
          <select id="adType" onchange="updatePriceInfo()">
            <option value="">Select ad type...</option>
            <option value="video">üé¨ Video Advertisement</option>
            <option value="banner">üñºÔ∏è Banner Advertisement</option>
            <option value="sticky">üìå Sticky Ad (Desktop)</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>Campaign Duration</label>
          <select id="adDuration" onchange="updatePriceInfo()">
            <option value="">Select duration...</option>
            <option value="1">1 Month</option>
            <option value="6">6 Months</option>
            <option value="12">12 Months (1 Year)</option>
            <option value="60">60 Months (5 Years)</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>Target URL</label>
          <input type="url" id="adUrl" placeholder="https://example.com">
        </div>
        
        <div class="form-group">
          <label>Upload Ad File</label>
          <input type="file" id="adFile" accept="image/*,video/*">
        </div>
        
        <div id="priceDisplay" class="price-display" style="display:none;">
          <h3>Campaign Pricing</h3>
          <div class="price-amount" id="priceAmount">LKR 0</div>
          <div class="price-details">
            <div><strong>Type:</strong> <span id="priceType">-</span></div>
            <div><strong>Duration:</strong> <span id="priceDuration">-</span></div>
            <div><strong>Start Date:</strong> <span id="startDate">-</span></div>
            <div><strong>End Date:</strong> <span id="endDate">-</span></div>
          </div>
        </div>
        
        <button class="btn btn-primary" onclick="uploadAd()">
          <span>üì§</span> Upload Advertisement
        </button>
        
        <div class="section-header" style="margin-top: 24px;">
          <span class="section-icon">üí≥</span>
          <h2>Payment Method</h2>
        </div>
        
        <div class="payment-grid">
          <div class="payment-option" onclick="openBankSlipUpload()">
            <span class="payment-icon">üè¶</span>
            <div>
              <div>Bank Transfer</div>
              <div style="font-size: 11px; color: #6b7280;">Direct deposit</div>
            </div>
          </div>
          <div class="payment-option disabled">
            <span class="payment-icon">üí∞</span>
            <div>
              <div>PayPal</div>
              <div style="font-size: 11px; color: #6b7280;">Fast & secure</div>
            </div>
          </div>
          <div class="payment-option disabled">
            <span class="payment-icon">üí≥</span>
            <div>
              <div>MasterCard</div>
              <div style="font-size: 11px; color: #6b7280;">Credit/Debit card</div>
            </div>
          </div>
          <div class="payment-option disabled">
            <span class="payment-icon">üí≥</span>
            <div>
              <div>Visa Card</div>
              <div style="font-size: 11px; color: #6b7280;">Credit/Debit card</div>
            </div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-header">
          <span class="section-icon">üìä</span>
          <h2>Analytics Overview</h2>
        </div>
        <div class="chart-container">
          <canvas id="analyticsChart"></canvas>
        </div>
      </div>

      <div class="section section-full">
        <div class="section-header">
          <span class="section-icon">üìã</span>
          <h2>Active Campaigns</h2>
        </div>
        <div id="adsList"></div>
      </div>
    </main>

    <!-- Bank Slip Upload Modal -->
    <div class="slip-upload-modal" id="slipUploadModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>üè¶ Bank Deposit Upload</h3>
          <button class="close-modal" onclick="closeSlipModal()">√ó</button>
        </div>
        
        <div class="bank-details">
          <h4 style="margin-bottom: 12px; color: #3b82f6;">Bank Account Details</h4>
          <p><strong>Bank Name:</strong> Commercial Bank of Ceylon</p>
          <p><strong>Account Name:</strong> Moovied Advertising Ltd.</p>
          <p><strong>Account Number:</strong> 1234567890</p>
          <p><strong>Branch:</strong> Colombo Main Branch</p>
          <p><strong>SWIFT Code:</strong> CCEYLKLX</p>
        </div>
        
        <div class="upload-area" id="uploadArea" onclick="document.getElementById('slipFileInput').click()">
          <div class="upload-icon">üìÑ</div>
          <h4>Upload Payment Slip</h4>
          <p style="color: #6b7280; margin-top: 8px;">Click to browse or drag and drop</p>
          <p style="color: #6b7280; font-size: 11px; margin-top: 4px;">Supported: JPG, PNG, PDF (Max 5MB)</p>
        </div>
        
        <input type="file" id="slipFileInput" accept="image/*,.pdf" onchange="handleSlipUpload(event)">
        
        <div class="file-preview" id="filePreview">
          <p>‚úÖ <strong>File Selected:</strong> <span id="fileName"></span></p>
        </div>
        
        <button class="btn btn-primary" onclick="submitSlip()" style="margin-top: 16px;">
          <span>üì§</span> Submit Payment Slip
        </button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.min.js"></script>
  <script>
    const state = {
      isAuthenticated: false,
      ads: [],
      userEmail: '',
      userName: 'User',
      profileImage: 'https://cdn-icons-png.flaticon.com/512/149/149071.png',
      selectedSlipFile: null,
      APPS_SCRIPT_URL: 'https://m-ads.mooviedsited.workers.dev',
      WORKER_URL: 'https://m-ads.mooviedsited.workers.dev',
      SUPPORT_PHONE: '+94770342724'
    };

    const pricing = {
      video: {1: 850, 6: 4950, 12: 9500, 60: 55000},
      banner: {1: 450, 6: 2500, 12: 4950, 60: 26500},
      sticky: {1: 250, 6: 1500, 12: 2950, 60: 14000}
    };

    let chartInstance = null;

    // Authentication Functions
    function showSignup() {
      document.getElementById('signin-form').style.display = 'none';
      document.getElementById('signup-form').style.display = 'flex';
    }

    function showSignin() {
      document.getElementById('signup-form').style.display = 'none';
      document.getElementById('signin-form').style.display = 'flex';
    }

    async function handleSignIn(event) {
      event.preventDefault();
      const email = document.getElementById('signinEmail').value;
      const password = document.getElementById('signinPassword').value;
      const rememberMe = document.getElementById('rememberMe').checked;

      console.log('Sign-in attempt:', { email });

      try {
        const response = await fetch(`${state.APPS_SCRIPT_URL}?action=fetchUser&email=${encodeURIComponent(email)}`, {
          method: 'GET'
        });
        const result = await response.json();
        console.log('Sign-in response:', result);

        if (result.success && result.user && result.user.password === password) {
          state.isAuthenticated = true;
          state.userEmail = email;
          state.userName = result.user.name;
          state.profileImage = result.user.profileImage || state.profileImage;
          document.getElementById('profileIcon').src = state.profileImage;
          showDashboard();
          if (rememberMe) {
            localStorage.setItem('userEmail', email);
            localStorage.setItem('userToken', btoa(email + ':' + password));
          }
          fetchUserAds();
          alert('‚úÖ Signed in successfully!');
        } else {
          alert('‚ùå Invalid email or password.');
        }
      } catch (error) {
        console.error('Sign-in error:', error);
        alert('‚ùå Sign-in failed: Network error. Please check your connection.');
      }
    }

    async function handleSignUp(event) {
      event.preventDefault();
      const name = document.getElementById('signupName').value;
      const email = document.getElementById('signupEmail').value;
      const business = document.getElementById('signupBusiness').value;
      const phone = document.getElementById('signupPhone').value;
      const password = document.getElementById('signupPassword').value;

      const phoneRegex = /^(\+94\d{9}|0\d{9})$/;
      if (!phoneRegex.test(phone)) {
        alert('‚ùå Invalid phone number. Use format: +94XXXXXXXXX or 0XXXXXXXXX');
        return;
      }

      const formData = new FormData();
      formData.append('action', 'registerUser');
      formData.append('name', name);
      formData.append('email', email);
      formData.append('business', business);
      formData.append('phone', phone);
      formData.append('password', password);

      console.log('Sign-up attempt:', { name, email, business, phone });

      try {
        const response = await fetch(state.APPS_SCRIPT_URL, {
          method: 'POST',
          body: formData
        });
        const result = await response.json();
        console.log('Sign-up response:', result);

        if (result.success) {
          state.isAuthenticated = true;
          state.userEmail = email;
          state.userName = name;
          showDashboard();
          localStorage.setItem('userEmail', email);
          localStorage.setItem('userToken', btoa(email + ':' + password));
          fetchUserAds();
          alert('‚úÖ Account created successfully!');
        } else {
          alert('‚ùå Sign-up failed: ' + result.error);
        }
      } catch (error) {
        console.error('Sign-up error:', error);
        alert('‚ùå Sign-up failed: Network error. Please check your connection.');
      }
    }

    function logout() {
      if (confirm('Are you sure you want to logout?')) {
        state.isAuthenticated = false;
        state.ads = [];
        state.userEmail = '';
        state.userName = 'User';
        state.selectedSlipFile = null;
        localStorage.removeItem('userEmail');
        localStorage.removeItem('userToken');
        document.getElementById('dashboardContainer').classList.add('hidden');
        document.getElementById('authContainer').classList.remove('hidden');
        showSignin();
        alert('üëã Logged out successfully!');
      }
    }

    // Dashboard Functions
    const profileIcon = document.getElementById('profileIcon');
    const settingsMenu = document.getElementById('settingsMenu');
    const uploadArea = document.getElementById('uploadArea');

    if (profileIcon && settingsMenu) {
      profileIcon.onclick = () => settingsMenu.classList.toggle('active');
      document.addEventListener('click', (e) => {
        if (!profileIcon.contains(e.target) && !settingsMenu.contains(e.target)) {
          settingsMenu.classList.remove('active');
        }
      });
    }

    if (uploadArea) {
      uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadArea.classList.add('drag-over');
      });
      uploadArea.addEventListener('dragleave', () => {
        uploadArea.classList.remove('drag-over');
      });
      uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadArea.classList.remove('drag-over');
        const files = e.dataTransfer.files;
        if (files.length > 0) {
          handleSlipUpload({ target: { files: [files[0]] } });
        }
      });
    }

    function goHome() {
      fetchUserAds();
      settingsMenu.classList.remove('active');
    }

    function changeName() {
      const newName = prompt('Enter new name:', state.userName);
      if (newName) {
        state.userName = newName;
        alert('‚úÖ Name updated!');
      }
      settingsMenu.classList.remove('active');
    }

    function changeProfileImage() {
      const newImage = prompt('Enter new profile image URL:', state.profileImage);
      if (newImage) {
        state.profileImage = newImage;
        document.getElementById('profileIcon').src = newImage;
        alert('‚úÖ Profile image updated!');
      }
      settingsMenu.classList.remove('active');
    }

    function contactMoovied() {
      alert(`üìû Contact us at ${state.SUPPORT_PHONE} or support@moovied.com`);
      settingsMenu.classList.remove('active');
    }

    function openBankSlipUpload() {
      document.getElementById('slipUploadModal').classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeSlipModal() {
      document.getElementById('slipUploadModal').classList.remove('active');
      document.body.style.overflow = 'auto';
      document.getElementById('filePreview').classList.remove('active');
      document.getElementById('slipFileInput').value = '';
      state.selectedSlipFile = null;
    }

    function handleSlipUpload(event) {
      const file = event.target.files[0];
      if (file) {
        const maxSize = 5 * 1024 * 1024; // 5MB
        const allowedTypes = ['image/jpeg', 'image/png', 'image/jpg', 'application/pdf'];
        if (file.size > maxSize) {
          alert('‚ùå File size exceeds 5MB.');
          return;
        }
        if (!allowedTypes.includes(file.type)) {
          alert('‚ùå Invalid file type. Use JPG, PNG, or PDF.');
          return;
        }
        state.selectedSlipFile = file;
        document.getElementById('fileName').textContent = file.name;
        document.getElementById('filePreview').classList.add('active');
      }
    }

    async function submitSlip() {
      if (!state.selectedSlipFile) {
        alert('‚ùå Please select a payment slip.');
        return;
      }
      alert('‚úÖ Payment slip selected. Proceed to upload ad.');
      closeSlipModal();
    }

    function updatePriceInfo() {
      const type = document.getElementById('adType').value;
      const duration = document.getElementById('adDuration').value;
      
      if (!type || !duration) {
        document.getElementById('priceDisplay').style.display = 'none';
        return;
      }
      
      const price = pricing[type][duration];
      const startDate = new Date();
      const endDate = new Date();
      endDate.setMonth(endDate.getMonth() + parseInt(duration));
      
      document.getElementById('priceDisplay').style.display = 'block';
      document.getElementById('priceAmount').textContent = `LKR ${price.toLocaleString()}`;
      document.getElementById('priceType').textContent = type.charAt(0).toUpperCase() + type.slice(1);
      document.getElementById('priceDuration').textContent = duration == 60 ? '5 Years' : duration + ' Months';
      document.getElementById('startDate').textContent = startDate.toLocaleDateString();
      document.getElementById('endDate').textContent = endDate.toLocaleDateString();
    }

    async function uploadAd() {
      if (!state.isAuthenticated) {
        alert('‚ùå Please sign in to upload ads.');
        showSignin();
        return;
      }

      const title = document.getElementById('adTitle').value;
      const type = document.getElementById('adType').value;
      const duration = document.getElementById('adDuration').value;
      const url = document.getElementById('adUrl').value;
      const fileInput = document.getElementById('adFile');
      
      if (!title || !type || !duration || !url || !fileInput.files[0]) {
        alert('‚ùå Please fill all fields and select an ad file.');
        return;
      }
      
      if (!state.selectedSlipFile) {
        alert('‚ùå Please upload a payment slip first.');
        openBankSlipUpload();
        return;
      }

      const adFile = fileInput.files[0];
      const formData = new FormData();
      formData.append('action', 'uploadAd');
      formData.append('email', state.userEmail);
      formData.append('name', state.userName);
      formData.append('title', title);
      formData.append('type', type);
      formData.append('duration', duration);
      formData.append('targetUrl', url);

      console.log('Ad upload attempt:', { title, type, duration, url });

      const adReader = new FileReader();
      adReader.onload = async (e) => {
        formData.append('adFile', e.target.result);
        formData.append('fileExt', adFile.name.split('.').pop());
        formData.append('mimeType', adFile.type);

        const slipReader = new FileReader();
        slipReader.onload = async (f) => {
          formData.append('slipFile', f.target.result);
          formData.append('slipExt', state.selectedSlipFile.name.split('.').pop());
          formData.append('slipMimeType', state.selectedSlipFile.type);

          try {
            const response = await fetch(state.APPS_SCRIPT_URL, { method: 'POST', body: formData });
            const result = await response.json();
            console.log('Ad upload response:', result);

            if (result.success) {
              alert('‚úÖ Ad uploaded - pending approval!');
              document.getElementById('adTitle').value = '';
              document.getElementById('adType').value = '';
              document.getElementById('adDuration').value = '';
              document.getElementById('adUrl').value = '';
              document.getElementById('adFile').value = '';
              state.selectedSlipFile = null;
              fetchUserAds();
            } else {
              alert('‚ùå Upload failed: ' + result.error);
            }
          } catch (error) {
            console.error('Ad upload error:', error);
            alert('‚ùå Upload failed: Network error. Please check your connection.');
          }
        };
        slipReader.readAsDataURL(state.selectedSlipFile);
      };
      adReader.readAsDataURL(adFile);
    }

    async function fetchUserAds() {
      if (!state.userEmail) return;
      try {
        const response = await fetch(`${state.APPS_SCRIPT_URL}?email=${encodeURIComponent(state.userEmail)}`, {
          method: 'GET'
        });
        const result = await response.json();
        console.log('Fetch ads response:', result);

        if (result.success) {
          state.ads = result.ads;
          renderAds();
          updateOverview();
          updateChart();
        } else {
          console.error('Fetch ads error:', result.error);
        }
      } catch (error) {
        console.error('Fetch ads failed:', error);
      }
    }

    function renderAds() {
      const adsList = document.getElementById('adsList');
      if (!state.ads || state.ads.length === 0) {
        adsList.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">üì≠</div>
            <h3>No Active Campaigns</h3>
            <p>Upload your first advertisement to get started</p>
          </div>`;
        return;
      }

      adsList.innerHTML = state.ads.map((ad, index) => {
        const now = new Date();
        const endDate = new Date(ad.endDate);
        const daysRemaining = Math.ceil((endDate - now) / (1000 * 60 * 60 * 24));
        
        let statusBadge = '';
        if (ad.status === 'pending') {
          statusBadge = '<span class="status-badge status-pending">Pending</span>';
        } else if (ad.status === 'active') {
          statusBadge = `<span class="status-badge status-active">Active</span><br>
            <a href="${state.WORKER_URL}?adId=${ad.adId}&url=${encodeURIComponent(ad.targetUrl)}" target="_blank">üìé Ad Link</a>`;
        } else if (ad.status === 'rejected') {
          statusBadge = `<span class="status-badge status-rejected">Rejected: Contact support at ${state.SUPPORT_PHONE}</span>`;
        } else if (ad.status === 'expired') {
          statusBadge = '<span class="status-badge status-expired">Expired</span>';
        }

        const ctr = ad.views > 0 ? ((ad.clicks / ad.views) * 100).toFixed(2) : '0.00';
        const avgWatchTime = ad.views > 0 ? (ad.watchTime / ad.views).toFixed(1) : '0.0';

        return `
          <div class="ad-card">
            <div class="ad-card-header">
              <div>
                <div class="ad-title">${ad.title}</div>
                ${statusBadge}
              </div>
              <span class="ad-type-badge">${ad.type}</span>
            </div>
            <div class="ad-stats-grid">
              <div class="stat-box">
                <div class="stat-label">Views</div>
                <div class="stat-value">${ad.views.toLocaleString()}</div>
              </div>
              <div class="stat-box">
                <div class="stat-label">Clicks</div>
                <div class="stat-value">${ad.clicks.toLocaleString()}</div>
              </div>
              <div class="stat-box">
                <div class="stat-label">CTR</div>
                <div class="stat-value small">${ctr}%</div>
              </div>
              <div class="stat-box">
                <div class="stat-label">Watch Time</div>
                <div class="stat-value small">${formatWatchTime(ad.watchTime)}</div>
              </div>
            </div>
            <div class="ad-dates">
              <div class="date-item">
                <div class="date-label">Start Date</div>
                <div class="date-value">${new Date(ad.startDate).toLocaleDateString()}</div>
              </div>
              <div class="date-item">
                <div class="date-label">End Date</div>
                <div class="date-value">${new Date(ad.endDate).toLocaleDateString()}</div>
              </div>
              <div class="date-item">
                <div class="date-label">Days Remaining</div>
                <div class="date-value">${daysRemaining > 0 ? daysRemaining : 0} days</div>
              </div>
              <div class="date-item">
                <div class="date-label">Avg. Watch Time</div>
                <div class="date-value">${avgWatchTime}s</div>
              </div>
            </div>
            <div class="ad-actions">
              <button class="btn btn-small btn-success" onclick="trackAd('${ad.adId}', 'view')">+ Add View</button>
              <button class="btn btn-small btn-success" onclick="trackAd('${ad.adId}', 'click')">+ Add Click</button>
              <button class="btn btn-small btn-success" onclick="trackAd('${ad.adId}', 'watchTime', ${Math.floor(Math.random() * 60) + 10})">+ Add Watch Time</button>
              <button class="btn btn-small btn-danger" onclick="deleteAd('${ad.adId}')">üóëÔ∏è Delete</button>
            </div>
          </div>`;
      }).join('');
    }

    function formatWatchTime(seconds) {
      if (seconds < 60) return `${seconds}s`;
      if (seconds < 3600) return `${Math.floor(seconds / 60)}m ${seconds % 60}s`;
      const hours = Math.floor(seconds / 3600);
      const minutes = Math.floor((seconds % 3600) / 60);
      return `${hours}h ${minutes}m`;
    }

    async function trackAd(adId, type, value = 1) {
      try {
        const response = await fetch(state.WORKER_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ action: 'trackAd', adId, type, value })
        });
        const result = await response.json();
        console.log('Track response:', result);
        if (result.success) {
          fetchUserAds();
          alert(`‚úÖ Tracked ${type}!`);
        } else {
          alert('‚ùå Tracking failed.');
        }
      } catch (error) {
        console.error('Track error:', error);
        alert('‚ùå Tracking failed: Network error.');
      }
    }

    async function deleteAd(adId) {
      if (confirm('Are you sure you want to delete this advertisement?')) {
        try {
          const formData = new FormData();
          formData.append('action', 'deleteAd');
          formData.append('email', state.userEmail);
          formData.append('adId', adId);

          const response = await fetch(state.APPS_SCRIPT_URL, {
            method: 'POST',
            body: formData
          });
          const result = await response.json();
          console.log('Delete ad response:', result);

          if (result.success) {
            alert('‚úÖ Ad deleted successfully!');
            fetchUserAds();
          } else {
            alert('‚ùå Delete failed: ' + result.error);
          }
        } catch (error) {
          console.error('Delete ad error:', error);
          alert('‚ùå Delete failed: Network error.');
        }
      }
    }

    function updateOverview() {
      const totalAds = state.ads.length;
      const totalViews = state.ads.reduce((sum, ad) => sum + ad.views, 0);
      const totalClicks = state.ads.reduce((sum, ad) => sum + ad.clicks, 0);
      const totalWatchTime = state.ads.reduce((sum, ad) => sum + ad.watchTime, 0);

      document.getElementById('totalAds').textContent = totalAds.toLocaleString();
      document.getElementById('totalViews').textContent = totalViews.toLocaleString();
      document.getElementById('totalClicks').textContent = totalClicks.toLocaleString();
      document.getElementById('totalWatchTime').textContent = formatWatchTime(totalWatchTime);
    }

    function updateChart() {
      const ctx = document.getElementById('analyticsChart').getContext('2d');
      const labels = state.ads.map(ad => ad.title);
      const viewsData = state.ads.map(ad => ad.views);
      const clicksData = state.ads.map(ad => ad.clicks);
      const watchTimeData = state.ads.map(ad => ad.watchTime);

      if (chartInstance) {
        chartInstance.destroy();
      }

      chartInstance = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels.length ? labels : ['No Data'],
          datasets: [
            {
              label: 'Views',
              data: viewsData.length ? viewsData : [0],
              backgroundColor: 'rgba(59, 130, 246, 0.5)',
              borderColor: '#3b82f6',
              borderWidth: 1
            },
            {
              label: 'Clicks',
              data: clicksData.length ? clicksData : [0],
              backgroundColor: 'rgba(168, 85, 247, 0.5)',
              borderColor: '#a855f7',
              borderWidth: 1
            },
            {
              label: 'Watch Time (s)',
              data: watchTimeData.length ? watchTimeData : [0],
              backgroundColor: 'rgba(34, 197, 94, 0.5)',
              borderColor: '#22c55e',
              borderWidth: 1
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              ticks: { color: '#d1d5db' },
              grid: { color: 'rgba(255,255,255,0.1)' }
            },
            x: {
              ticks: { color: '#d1d5db' },
              grid: { color: 'rgba(255,255,255,0.1)' }
            }
          },
          plugins: {
            legend: {
              labels: { color: '#d1d5db' }
            }
          }
        }
      });
    }

    function showDashboard() {
      document.getElementById('authContainer').classList.add('hidden');
      document.getElementById('dashboardContainer').classList.remove('hidden');
    }

    // Auto-login if token exists
    window.onload = () => {
      const savedEmail = localStorage.getItem('userEmail');
      const savedToken = localStorage.getItem('userToken');
      if (savedEmail && savedToken) {
        const [email, password] = atob(savedToken).split(':');
        document.getElementById('signinEmail').value = email;
        document.getElementById('signinPassword').value = password;
        document.getElementById('rememberMe').checked = true;
        handleSignIn(new Event('submit'));
      }
    };
  </script>
</body>
</html>
